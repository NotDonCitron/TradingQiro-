---
name: Core Security Standards
description: Enforce security best practices for secrets and logging.
globs:
  - "**/*.py"
  - "**/docker-compose.yml"
  - "**/Dockerfile*"
alwaysApply: true
---
- Verwende Environment-Variablen für alle Secrets (z. B. via .env oder secrets.enc); keine Hardcoding in Code/Logs.
- Logge keine sensiblen Daten (z. B. Tokens, Passwörter) – nutze structured logging mit Masking.
- Prüfe auf Klartext-Secrets in Commits; integriere Scanner wie TruffleHog in CI.
- Trenne dev/prod-Configs: Defaults in .env.example, Overrides via Env Vars.
- Handle Edge-Cases: Validiere Env-Vars beim Start (z. B. mit pydantic).
- Dokumentiere Security in README: "Keine Secrets in Images/Logs – siehe secrets.enc".
- Für Docker: Keine Secrets in Images; übergebe via --env-file.
- Trigger: Bei File-Change in Python/Docker – schlage Fixes vor.
